{"title":"Network Mapping the Most Influential Addresses using DAI (2021): Extracting Blockchain Data from Public Google Datasets with BigQuery and SQL","markdown":{"yaml":{"title":"Network Mapping the Most Influential Addresses using DAI (2021): Extracting Blockchain Data from Public Google Datasets with BigQuery and SQL","author":"Victor Lao","date":"2022-08-30","output":{"blogdown::html_page":{"toc":true}}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\nBlockchain technologies are inarguably reshaping how the general public thinks\nof finance. One particularly interesting innovation is the concept of\ndecentralized autonomous organizations (or DAOs). Leveraging the transparency of\nthe blockchain, DAOs endeavour to collaboratively run organizations in a \ntrustless way. This novel method of conducting corporate operations makes a \ncompelling subject for analysis.\n\nOne prominent DAO is MakerDAO. They are most well known for their \nover-collateralized USD stable coin, DAI. As all core MakerDAO operations and\nproducts operate through the blockchain, I retrieved all emitted event logs \npertaining to MakerDAO smart contracts (executes blockchain functions) using\nBigQuery and the MakerDAO technical docs.\n\n## Methodology\n\nTable of MakerDAO events was created using the publicly available Ethereum\nblockchain dataset on BigQuery. As addresses are stored on the blockchain as\na 42 character hexadecimal, all smart contract addresses were converted to their\ncontract name using MakerDAO technical docs. Topic 0 of event logs typically\ncontains a unqiue event type specific index and was used to annotate function \nevents. Each unique event type was individually parsed for sender identity,\nreciever identity and value. Makerdao stores values as integers which stand for\ndiffering decimals of percision depending on the event type. An unfortunate\nside effect of this storage method is that the values are too large for BigQuery\nto handle (can only go up to INT64). This necessitated using R to view the\ncorrect values. Values were stored on BigQuery as hexadecimals.\n```{sql eval=FALSE}\nCREATE TABLE \n     makerdao_operations.may2021to2022\nPARTITION BY DATE (\n     block_timestamp\n)\nCLUSTER BY\n     makerdao_smartcontract,\n     makerdao_function\nAS (\n\nSELECT\n     logs.block_timestamp AS block_timestamp,\n     transaction_hash,\n     from_address,\n     to_address,\n     value AS eth_value,\n     gas_price,\n     CASE\n          WHEN address = '0x6b175474e89094c44da98b954eedeac495271d0f' THEN 'DAI'\n          WHEN address = '0x9759A6Ac90977b93B58547b4A71c78317f391A28' THEN 'DAIJOIN'\n          WHEN address = '0x2F0b23f53734252Bda2277357e97e1517d6B042A' THEN 'GEMJOIN'\n          WHEN address = '0x197E90f9FAD81970bA7976f33CbD77088E5D7cf7' THEN 'POT'\n          WHEN address = '0x19c0976f590D67707E62397C87829d896Dc0f1F1' THEN 'JUG'\n          WHEN address = '0xA950524441892A31ebddF91d3cEEFa04Bf454466' THEN 'VOW'\n          WHEN address = '0xC4269cC7acDEdC3794b221aA4D9205F564e27f0d' THEN 'FLAPPER'\n          WHEN address = '0xA41B6EF151E06da0e34B009B86E828308986736D' THEN 'FLOPPER'\n          WHEN address = '0x35D1b3F3D7966A1DFe207aa4514C12a259A0492B' THEN 'VAT'\n          WHEN address = '0x65C79fcB50Ca1594B025960e539eD7A9a6D434A3' THEN 'SPOT'\n          WHEN address = '0x135954d155898D42C90D2a57824C690e0c7BEf1B' THEN 'DOG'\n          WHEN address = '0xc67963a226eddd77B91aD8c421630A1b0AdFF270' THEN 'CLIPPER'\n          WHEN address = '0x1EB4CF3A948E7D72A198fe073cCb8C7a948cD853' THEN 'FLASH'\n          WHEN address = '0x9f8F72aA9304c8B593d555F12eF6589cC3A579A2' THEN 'MKR'\n          WHEN address = '0x0a3f6849f78076aefaDf113F5BED87720274dDC0' THEN 'DSCHIEF'\n          WHEN address = '0xA618E54de493ec29432EbD2CA7f14eFbF6Ac17F7' THEN 'DSTOKEN'\n          WHEN address = '0x82ecD135Dce65Fbc6DbdD0e4237E0AF93FFD5038' THEN 'PROXY'\n          WHEN address = '0x5ef30b9986345249bc32d8928B7ee64DE9435E39' THEN 'CDPMANAGER'\n               END AS makerdao_smartcontract,\n     CASE\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(1)] NOT IN (\n                                        '0x0000000000000000000000000000000000000000',\n                                        '0x2F0b23f53734252Bda2277357e97e1517d6B042A',\n                                        '0x0a3f6849f78076aefadf113f5bed87720274ddc0'\n                                        )                                                               AND\n               topics[OFFSET(2)] NOT IN ('0x0000000000000000000000000000000000000000',\n                                        '0x2F0b23f53734252Bda2277357e97e1517d6B042A',\n                                        '0x0a3f6849f78076aefadf113f5bed87720274ddc0'\n                                        )                                                               THEN 'transfer' --DAI/MKR/IOU\n          WHEN topics[OFFSET(0)] = '0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925' THEN 'approve' --DAI/MKR/IOU\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(1)] = '0x0000000000000000000000000000000000000000'                         THEN 'mint/exit' --DAIJOIN\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(2)] = '0x0000000000000000000000000000000000000000'                         THEN 'burn/join' --DAIJOIN\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(1)] = '0x2F0b23f53734252Bda2277357e97e1517d6B042A'                         THEN 'mint/exit' --GEMJOIN\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(2)] = '0x2F0b23f53734252Bda2277357e97e1517d6B042A'                         THEN 'burn/join' --GEMJOIN\n          WHEN topics[OFFSET(0)] = '0x9f678cca00000000000000000000000000000000000000000000000000000000' THEN 'drip' --POT\n          WHEN topics[OFFSET(0)] = '0x7f8661a100000000000000000000000000000000000000000000000000000000' THEN 'exit' --POT\n          WHEN topics[OFFSET(0)] = '0x049878f300000000000000000000000000000000000000000000000000000000' THEN 'join' --POT\n          WHEN topics[OFFSET(0)] = '0x44e2a5a800000000000000000000000000000000000000000000000000000000' THEN 'drip' --JUG\n          WHEN topics[OFFSET(0)] = '0xf37ac61c00000000000000000000000000000000000000000000000000000000' THEN 'heal' --VOW/VAT\n          WHEN topics[OFFSET(0)] = '0xd7ee674b00000000000000000000000000000000000000000000000000000000' THEN 'flog' --VOW\n          WHEN topics[OFFSET(0)] = '0xc959c42b00000000000000000000000000000000000000000000000000000000' THEN 'deal' --FLAPPER\n          WHEN topics[OFFSET(0)] = '0xa3b22fc400000000000000000000000000000000000000000000000000000000' THEN 'hope' --VAT\n          WHEN topics[OFFSET(0)] = '0xdc4d20fa00000000000000000000000000000000000000000000000000000000' THEN 'nope' --VAT\n          WHEN topics[OFFSET(0)] = '0xbb35783b00000000000000000000000000000000000000000000000000000000' THEN 'move' --VAT\n          WHEN topics[OFFSET(0)] = '0x7cdd3fde00000000000000000000000000000000000000000000000000000000' THEN 'slip' --VAT\n          WHEN topics[OFFSET(0)] = '0x7bab3f4000000000000000000000000000000000000000000000000000000000' THEN 'grab' --VAT\n          WHEN topics[OFFSET(0)] = '0xdfd7467e425a8107cfd368d159957692c25085aacbcf5228ce08f10f2146486e' THEN 'poke' --SPOT\n          WHEN topics[OFFSET(0)] = '0x85258d09e1e4ef299ff3fc11e74af99563f022d21f3f940db982229dc2a3358c' THEN 'bark' --DOG\n          WHEN topics[OFFSET(0)] = '0x54f095dc7308776bf01e8580e4dd40fd959ea4bf50b069975768320ef8d77d8a' THEN 'digs' --DOG\n          WHEN topics[OFFSET(0)] = '0x7c5bfdc0a5e8192f6cd4972f382cec69116862fb62e6abff8003874c58e064b8' THEN 'kick' --CLIPPER\n          WHEN topics[OFFSET(0)] = '0x05e309fd6ce72f2ab888a20056bb4210df08daed86f21f95053deb19964d86b1' THEN 'take' --CLIPPER\n          WHEN topics[OFFSET(0)] = '0x0d7d75e01ab95780d3cd1c8ec0dd6c2ce19e3a20427eec8bf53283b6fb8e95f0' THEN 'flashloan' --FLASH\n          WHEN topics[OFFSET(0)] = '0xcc16f5dbb4873280815c1ee09dbd06736cffcc184412cf7a71a0fdb75d397ca5' THEN 'burn' --MKR/DSTOKEN\n          WHEN topics[OFFSET(0)] = '0x0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885' THEN 'mint' --MKR/DSTOKEN\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(1)] = '0x0a3f6849f78076aefadf113f5bed87720274ddc0'                         THEN 'free' --DSCHIEF\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' AND\n               topics[OFFSET(2)] = '0x0a3f6849f78076aefadf113f5bed87720274ddc0'                         THEN 'lock' --DSCHIEF\n          WHEN topics[OFFSET(0)] = '0x4f0892983790f53eea39a7a496f6cb40e8811b313871337b6a761efc6c67bb1f' THEN 'etch' --DSCHIEF(slate) \n          WHEN topics[OFFSET(0)] IN (\n                                   '0xa69beaba00000000000000000000000000000000000000000000000000000000',\n                                   '0xed08132900000000000000000000000000000000000000000000000000000000'\n                                   )                                                                    THEN 'vote' --DSCHIEF\n          WHEN topics[OFFSET(0)] = '0xd6be0bc178658a382ff4f91c8c68b542aa6b71685b8fe427966b87745c3ea7a2' THEN 'open' --CDPMANAGER\n          WHEN topics[OFFSET(0)] = '0xfcafcc6800000000000000000000000000000000000000000000000000000000' THEN 'give' --CDPMANAGER\n          WHEN topics[OFFSET(0)] = '0x45e6bdcd00000000000000000000000000000000000000000000000000000000' THEN 'frob' --CDPMANAGER\n          WHEN topics[OFFSET(0)] = '0x9bb8f83800000000000000000000000000000000000000000000000000000000' THEN 'flux' --CDPMANAGER\n          WHEN topics[OFFSET(0)] = '0xf9f30db600000000000000000000000000000000000000000000000000000000' THEN 'move' --CDPMANAGER\n          WHEN topics[OFFSET(0)] = '0x1b0dbf7200000000000000000000000000000000000000000000000000000000' THEN 'quit' --CDPMANAGER\n               END AS makerdao_function,\n     CASE --note following are in hex string format (as the numbers are too big for... bigquery)\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' --transfer/burn/mint value\n               THEN data --wad (10e18)\n          WHEN topics[OFFSET(0)] = '0x7f8661a100000000000000000000000000000000000000000000000000000000' --pot/DSR exit value\n               THEN topics[OFFSET(2)] --wad\n          WHEN topics[OFFSET(0)] = '0x049878f300000000000000000000000000000000000000000000000000000000' --pot/DSR join value\n               THEN topics[OFFSET(3)] --wad\n          WHEN topics[OFFSET(0)] = '0xbb35783b00000000000000000000000000000000000000000000000000000000' --vat move value\n               THEN topics[OFFSET(2)] --rad (10e45)\n          WHEN topics[OFFSET(0)] = '0xf37ac61c00000000000000000000000000000000000000000000000000000000' --vow/vat heal amount\n               THEN topics[OFFSET(1)] --rad\n          WHEN topics[OFFSET(0)] = '0x7cdd3fde00000000000000000000000000000000000000000000000000000000' --vat slip amount\n               THEN topics[OFFSET(3)] --wad\n          WHEN topics[OFFSET(0)] = '0x7bab3f4000000000000000000000000000000000000000000000000000000000' --vat grab debt (dart) amount\n               THEN CONCAT('0x', SUBSTR(data, 459, 64)) --wad\n          WHEN topics[OFFSET(0)] = '0x85258d09e1e4ef299ff3fc11e74af99563f022d21f3f940db982229dc2a3358c' --dog bark liquidation (art)\n               THEN CONCAT('0x', SUBSTR(data, 67, 64)) --wad\n          WHEN topics[OFFSET(0)] = '0x7c5bfdc0a5e8192f6cd4972f382cec69116862fb62e6abff8003874c58e064b8' --clipper kick DAI debt (tab) \n               THEN CONCAT('0x', SUBSTR(data, 67, 64)) --rad\n          WHEN topics[OFFSET(0)] = '0x05e309fd6ce72f2ab888a20056bb4210df08daed86f21f95053deb19964d86b1' --clipper take bid (price) \n               THEN CONCAT('0x', SUBSTR(data, 67, 64)) --ray (10e27)\n          WHEN topics[OFFSET(0)] = '0x0d7d75e01ab95780d3cd1c8ec0dd6c2ce19e3a20427eec8bf53283b6fb8e95f0' --flashloan loan value (amount)\n               THEN CONCAT('0x', SUBSTR(data, 67, 64)) --ray\n          WHEN topics[OFFSET(0)] = '0xcc16f5dbb4873280815c1ee09dbd06736cffcc184412cf7a71a0fdb75d397ca5' --MKR/DSTOKEN burn value\n               THEN data --wad\n          WHEN topics[OFFSET(0)] = '0x0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885' --MKR/DSTOKEN mint value\n               THEN data --wad\n          WHEN topics[OFFSET(0)] = '0x45e6bdcd00000000000000000000000000000000000000000000000000000000' --CDPMANAGER frob debt change\n               THEN CONCAT('0x', SUBSTR(data, 267, 64)) --wad (assuming dart value of similar percision across contracts)\n          WHEN topics[OFFSET(0)] = '0x9bb8f83800000000000000000000000000000000000000000000000000000000' --CDPMANAGER flux collateral\n               THEN CONCAT('0x', SUBSTR(data, 203, 64)) --wad\n          WHEN topics[OFFSET(0)] = '0xf9f30db600000000000000000000000000000000000000000000000000000000' --CDPMANAGER move value\n               THEN CONCAT('0x', SUBSTR(data, 267, 64)) --rad\n                    END AS value,\n     CASE\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' --transfer/burn/mint\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925' --approve\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x9f678cca00000000000000000000000000000000000000000000000000000000' --drip\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x7f8661a100000000000000000000000000000000000000000000000000000000' --exit\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x049878f300000000000000000000000000000000000000000000000000000000' --join\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x44e2a5a800000000000000000000000000000000000000000000000000000000' --drip\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xf37ac61c00000000000000000000000000000000000000000000000000000000' --heal\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xd7ee674b00000000000000000000000000000000000000000000000000000000' --flog\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xc959c42b00000000000000000000000000000000000000000000000000000000' --deal\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xa3b22fc400000000000000000000000000000000000000000000000000000000' --hope\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xdc4d20fa00000000000000000000000000000000000000000000000000000000' --nope\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xbb35783b00000000000000000000000000000000000000000000000000000000' --move(vat)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x7bab3f4000000000000000000000000000000000000000000000000000000000' --grab (u; user liquidated)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x85258d09e1e4ef299ff3fc11e74af99563f022d21f3f940db982229dc2a3358c' --bark (urn liquidated)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x7c5bfdc0a5e8192f6cd4972f382cec69116862fb62e6abff8003874c58e064b8' --kick (auction id)\n               THEN SAFE_CAST(SAFE_CAST(topics[OFFSET(1)] AS INT64) AS STRING)\n          WHEN topics[OFFSET(0)] = '0x05e309fd6ce72f2ab888a20056bb4210df08daed86f21f95053deb19964d86b1' --take (who; auction bidder)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x0d7d75e01ab95780d3cd1c8ec0dd6c2ce19e3a20427eec8bf53283b6fb8e95f0' --flashloan (reciever)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xcc16f5dbb4873280815c1ee09dbd06736cffcc184412cf7a71a0fdb75d397ca5' --burn (DSTOKEN)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xa69beaba00000000000000000000000000000000000000000000000000000000' --vote\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xd6be0bc178658a382ff4f91c8c68b542aa6b71685b8fe427966b87745c3ea7a2' --open\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xfcafcc6800000000000000000000000000000000000000000000000000000000' --give (cdp id)\n               THEN topics[OFFSET(2)]\n          WHEN topics[OFFSET(0)] = '0x45e6bdcd00000000000000000000000000000000000000000000000000000000' --frob\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x9bb8f83800000000000000000000000000000000000000000000000000000000' --flux (cpd id)\n               THEN topics[OFFSET(2)]\n          WHEN topics[OFFSET(0)] = '0xf9f30db600000000000000000000000000000000000000000000000000000000' --move (cdp id)\n               THEN topics[OFFSET(2)]\n          WHEN topics[OFFSET(0)] = '0x1b0dbf7200000000000000000000000000000000000000000000000000000000' --quit (cdp id)\n               THEN topics[OFFSET(2)]\n                    END AS sender,\n     CASE\n          WHEN topics[OFFSET(0)] = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef' --transfer/burn/mint\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925' --approve\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xbb35783b00000000000000000000000000000000000000000000000000000000' --move(vat)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x7cdd3fde00000000000000000000000000000000000000000000000000000000' --slip(vat)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(2)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x7bab3f4000000000000000000000000000000000000000000000000000000000' --grab (w; user recieving debt)\n               THEN CONCAT('0x', SUBSTR(data, 355, 40)) --retrieve address from data (not logged)\n          WHEN topics[OFFSET(0)] = '0x85258d09e1e4ef299ff3fc11e74af99563f022d21f3f940db982229dc2a3358c' --bark (auction id)\n               THEN SAFE_CAST(SAFE_CAST(topics[OFFSET(3)] AS INT64) AS STRING)\n          WHEN topics[OFFSET(0)] = '0x7c5bfdc0a5e8192f6cd4972f382cec69116862fb62e6abff8003874c58e064b8' --kick (kpr of dai incentive)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(3)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x05e309fd6ce72f2ab888a20056bb4210df08daed86f21f95053deb19964d86b1' --take (auction id)\n               THEN SAFE_CAST(SAFE_CAST(topics[OFFSET(1)] AS INT64) AS STRING)\n          WHEN topics[OFFSET(0)] = '0x0d7d75e01ab95780d3cd1c8ec0dd6c2ce19e3a20427eec8bf53283b6fb8e95f0' --flashloan (token)\n               THEN CONCAT('0x', SUBSTR(data, 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885' --mint (DSTOKEN)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x4f0892983790f53eea39a7a496f6cb40e8811b313871337b6a761efc6c67bb1f' --etch\n               THEN topics[OFFSET(1)]\n          WHEN topics[OFFSET(0)] = '0xa69beaba00000000000000000000000000000000000000000000000000000000' --vote (slate)\n               THEN topics[OFFSET(2)]\n          WHEN topics[OFFSET(0)] = '0xd6be0bc178658a382ff4f91c8c68b542aa6b71685b8fe427966b87745c3ea7a2' --open (cdp id)\n               THEN topics[OFFSET(3)]\n          WHEN topics[OFFSET(0)] = '0xfcafcc6800000000000000000000000000000000000000000000000000000000' --give (dst address)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(1)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x45e6bdcd00000000000000000000000000000000000000000000000000000000' --frob (affected cdp)\n               THEN topics[OFFSET(2)]\n          WHEN topics[OFFSET(0)] = '0x9bb8f83800000000000000000000000000000000000000000000000000000000' --flux (dst)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(3)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0xf9f30db600000000000000000000000000000000000000000000000000000000' --move (dst)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(3)], 27, 40)) --remove zero padding\n          WHEN topics[OFFSET(0)] = '0x1b0dbf7200000000000000000000000000000000000000000000000000000000' --quit (dst)\n               THEN CONCAT('0x', SUBSTR(topics[OFFSET(3)], 27, 40)) --remove zero padding\n                    END AS reciever,\n     CASE WHEN topics[OFFSET(0)] IN ('0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',\n                                     '0x7f8661a100000000000000000000000000000000000000000000000000000000',\n                                     '0x049878f300000000000000000000000000000000000000000000000000000000',\n                                     '0x7cdd3fde00000000000000000000000000000000000000000000000000000000',\n                                     '0x7bab3f4000000000000000000000000000000000000000000000000000000000',\n                                     '0x85258d09e1e4ef299ff3fc11e74af99563f022d21f3f940db982229dc2a3358c',\n                                     '0xcc16f5dbb4873280815c1ee09dbd06736cffcc184412cf7a71a0fdb75d397ca5',\n                                     '0x0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885',\n                                     '0x45e6bdcd00000000000000000000000000000000000000000000000000000000',\n                                     '0x9bb8f83800000000000000000000000000000000000000000000000000000000'\n                                   )\n               THEN 'wad'\n          WHEN topics[OFFSET(0)] IN ('0x05e309fd6ce72f2ab888a20056bb4210df08daed86f21f95053deb19964d86b1',\n                                     '0x0d7d75e01ab95780d3cd1c8ec0dd6c2ce19e3a20427eec8bf53283b6fb8e95f0'\n                                   )\n               THEN 'ray'\n          WHEN topics[OFFSET(0)] IN ('0xbb35783b00000000000000000000000000000000000000000000000000000000',\n                                     '0xf37ac61c00000000000000000000000000000000000000000000000000000000',\n                                     '0x7c5bfdc0a5e8192f6cd4972f382cec69116862fb62e6abff8003874c58e064b8',\n                                     '0xf9f30db600000000000000000000000000000000000000000000000000000000'\n                                   )\n               THEN 'rad'\n                    END AS percision, --see value section\n     topics,\n     data\nFROM bigquery-public-data.crypto_ethereum.logs AS logs\nRIGHT JOIN bigquery-public-data.crypto_ethereum.transactions AS transactions\n     ON logs.transaction_hash = transactions.hash\nWHERE logs.block_timestamp BETWEEN '2021-05-30' and '2022-05-30'\n     AND address IN (\n     '0x6b175474e89094c44da98b954eedeac495271d0f', -- DAI address (ERC20 form)\n     '0x9759A6Ac90977b93B58547b4A71c78317f391A28', -- DAIJOIN address (mint/burn)\n     '0x2F0b23f53734252Bda2277357e97e1517d6B042A', -- GEMJOIN address (collateral)\n     '0x197E90f9FAD81970bA7976f33CbD77088E5D7cf7', -- POT address (savings contract)\n     '0x19c0976f590D67707E62397C87829d896Dc0f1F1', -- JUG address (stability fees)\n     '0xA950524441892A31ebddF91d3cEEFa04Bf454466', -- VOW address (balance sheet)\n     '0xC4269cC7acDEdC3794b221aA4D9205F564e27f0d', -- FLAPPER address (surplus)\n     '0xA41B6EF151E06da0e34B009B86E828308986736D', -- FLOPPER address (deficit - never been called thus far)\n     '0x35D1b3F3D7966A1DFe207aa4514C12a259A0492B', -- VAT address (vaults)\n     '0x135954d155898D42C90D2a57824C690e0c7BEf1B', -- DOG address (liquidations)\n     '0xc67963a226eddd77B91aD8c421630A1b0AdFF270', -- CLIPPER address (liquidations)\n     '0x1EB4CF3A948E7D72A198fe073cCb8C7a948cD853', -- FLASH address (flash loans)\n     '0x9f8F72aA9304c8B593d555F12eF6589cC3A579A2', -- MKR address (governance ERC20)\n     '0x0a3f6849f78076aefaDf113F5BED87720274dDC0', -- DSCHIEF address (governance voting system)\n     '0xA618E54de493ec29432EbD2CA7f14eFbF6Ac17F7', -- DSTOKEN address (governance IOU)\n     '0x82ecD135Dce65Fbc6DbdD0e4237E0AF93FFD5038', -- PROXY address (for proxy actions)\n     '0x5ef30b9986345249bc32d8928B7ee64DE9435E39'  -- CDPMANAGER address (for managing vaults)\n     )\n\n)\n\n```\n\n\n## References\n\nMakerDAO (2021). MakerDAO Technical Docs. URL https://docs.makerdao.com/\n\nGoogle (2021). BigQuery. URL https://cloud.google.com/bigquery\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"blogdown::html_page":{"toc":true}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"MakerDAO_dataset_generation_report.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","editor":"visual","theme":"lux","title":"Network Mapping the Most Influential Addresses using DAI (2021): Extracting Blockchain Data from Public Google Datasets with BigQuery and SQL","author":"Victor Lao","date":"2022-08-30"},"extensions":{"book":{"multiFile":true}}}}}